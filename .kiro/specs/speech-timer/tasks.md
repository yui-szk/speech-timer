# 実装計画

- [x] 1. プロジェクト基盤と開発環境のセットアップ
  - Vite + React + TypeScriptプロジェクトの初期化と設定
  - Tailwind CSSのインストールとカスタムテーマトークンの設定
  - VitestとReact Testing Libraryのテスト環境構築
  - ESLintとPrettierのコード品質設定
  - src/components、src/hooks、src/typesディレクトリの基本プロジェクト構造作成
  - _要件: 7.2_

- [x] 2. コアデータモデルと型定義の実装
  - TimerState、TimerSettings、BellStateのTypeScriptインターフェース作成
  - Millis型とProgressMode共用体型の定義
  - 時間入力（mm:ss形式）のバリデーション関数実装
  - 時間フォーマットと解析のユーティリティ関数作成
  - データモデルバリデーションの単体テスト作成
  - _要件: 1.3, 4.4_

- [x] 3. Zustandによる状態管理のセットアップ
  - Zustandの状態管理ライブラリのインストールと設定
  - タイマー、設定、ベル状態を含むメインアプリストアの作成
  - 基本タイマーアクション（開始、一時停止、リセット、時間設定）の実装
  - 設定アクション（updateSettings）の実装
  - 状態管理アクションの単体テスト作成
  - _要件: 3.1, 3.2, 3.3, 4.4_

- [x] 4. 高精度タイマーエンジンの実装
  - performance.now()とrequestAnimationFrameを使用したTimerEngineクラス作成
  - 時間計算ロジック（経過時間、残り時間、一時停止累積）の実装
  - タイマー状態遷移（idle → running → paused → finished）の追加
  - ±50ms精度を維持する精度監視機能の実装
  - Reactコンポーネントと統合するタイマーフック（useTimer）の作成
  - タイマー精度と状態遷移の包括的な単体テスト作成
  - _要件: 7.1, 7.3, 7.4_

- [x] 5. 基本アプリシェルとルーティング構造の作成
  - ヘッダー、メインコンテンツ、フッターを含むAppShellコンポーネントの実装
  - メインタイマーと設定画面のルートを含むReact Routerのセットアップ
  - モバイルファーストデザインのレスポンシブレイアウト構造作成
  - ミント/イエローカラートークンのテーマシステム実装
  - メイン画面と設定画面間の基本ナビゲーション追加
  - _要件: 5.1, 5.3_

- [x] 6. 編集機能付きTimeDisplayコンポーネントの構築
  - 大きく読みやすい形式で時間を表示するTimeDisplayコンポーネント作成
  - mm:ss入力バリデーション付きクリック編集機能の実装
  - 画面サイズに応じてスケールする流体タイポグラフィの追加
  - エラー状態を含む時間入力解析とバリデーションの処理
  - タイマー状態との統合による時間設定の更新
  - 表示と編集動作のコンポーネントテスト作成
  - _要件: 1.1, 1.3, 5.4_

- [x] 7. CircularProgressコンポーネントの実装
  - SVGを使用した円形プログレスバーコンポーネントの作成
  - 残り時間と経過時間両モードの進捗計算実装
  - CSSトランスフォームを使用したスムーズなアニメーション遷移の追加
  - プログレスモード切り替え（残り時間/経過時間）のサポート
  - プログレスバーとタイマー状態の同期確保
  - 進捗計算とモード切り替えのテスト作成
  - _要件: 1.2, 4.2_

- [x] 8. キーボードショートカット付きコントロールボタンの作成
  - 適切なサイズ（最小44x44px）のリセット、ベルテスト、再生/一時停止ボタンの実装
  - キーボードショートカット（Space：再生/一時停止、R：リセット、B：ベルテスト）の追加
  - 適切なフォーカス管理とフォーカスリングの実装
  - ARIAラベルとセマンティックボタンロールの追加
  - タイマー状態に基づくボタン状態変更の処理
  - ボタン操作とキーボードショートカットのテスト作成
  - _要件: 3.1, 3.2, 3.3, 3.4, 3.5, 5.2, 6.1, 6.2_

- [x] 9. ベルスケジューリングとオーディオシステムの構築
  - ベル音用OscillatorNodeを使用したWeb Audio APIマネージャーの実装
  - しきい値検出と重複防止機能付きベルスケジューリングロジックの作成
  - GainNodeを使用した音量制御（0-100%範囲）の追加
  - ベルトリガー検出（previousRemaining > threshold && currentRemaining <= threshold）の実装
  - 重複トリガーを防ぐベル状態管理の追加
  - ユーザージェスチャー処理付きオーディオコンテキスト初期化の作成
  - ベルスケジューリングロジックとオーディオシステムの単体テスト作成
  - _要件: 2.1, 2.2, 2.4, 2.5, 4.3_

- [x] 10. BellScheduleStripコンポーネントの作成
  - 1令、2令、3令のベル時間表示・編集UIの実装
  - 各ベルのON/OFFトグルスイッチの追加
  - mm:ss形式バリデーション付きベル時間のインライン編集実装
  - 有効/無効ベルの視覚的インジケーター表示
  - ベルスケジューリングシステムと設定永続化との統合
  - ベル設定UIのコンポーネントテスト作成
  - _要件: 2.1, 2.3_

- [x] 11. 開始時刻と現在時刻表示の追加
  - タイマー開始時刻と現在のリアルタイムを表示するStartAndNowClockコンポーネント作成
  - ローカライゼーション用Intl.DateTimeFormatを使用した時刻フォーマット
  - 現在時刻表示のリアルタイム更新
  - メイン画面下部へのコンポーネント配置
  - 時刻フォーマットと表示更新のテスト作成
  - _要件: 1.4_

- [ ] 12. 設定画面の実装
  - 戻るナビゲーション付きSettingsコンポーネントの作成
  - テーマ選択用ThemePickerの実装
  - 音量制御とテスト再生機能付きBellSoundPickerの追加
  - 残り時間/経過時間切り替え用ProgressModeToggleの作成
  - すべての設定変更がメイン画面に即座に反映されることの確保
  - 設定UIと即時更新のコンポーネントテスト作成
  - _要件: 4.1, 4.2, 4.3_

- [ ] 13. localStorage永続化の追加
  - localStorage操作用SettingsManagerの実装
  - 設定変更の自動保存機能追加
  - デフォルトフォールバック付きアプリ初期化時の設定読み込み実装
  - localStorageエラー（容量超過、利用不可）の適切な処理
  - 将来バージョン用の設定バリデーションとマイグレーション追加
  - 永続化、読み込み、エラー処理のテスト作成
  - _要件: 4.4, 4.5_

- [ ] 14. アクセシビリティとキーボードナビゲーションの強化
  - すべてのインタラクティブ要素への包括的ARIAラベル追加
  - 適切な見出し階層とセマンティックHTMLの実装
  - キーボードナビゲーションによる全機能アクセス確保
  - スキップリンクとフォーカス管理の追加
  - WCAG AA基準を満たすカラーコントラスト比のテスト
  - タイマー状態変更のスクリーンリーダー対応アナウンス実装
  - アクセシビリティテストと手動テストチェックリスト作成
  - _要件: 6.1, 6.2, 6.3, 6.4_

- [ ] 15. パフォーマンスとレスポンシブ性の最適化
  - 不要な再レンダリング防止のためのReact.memo実装
  - 高コスト計算用useMemoとuseCallbackの追加
  - タイマー更新頻度の最適化（60fps RAFと250ms表示スロットリング）
  - タブレットとデスクトップレイアウト用レスポンシブブレークポイント実装
  - フレームレートとタイミング精度のパフォーマンス監視追加
  - パフォーマンステストとベンチマーク作成
  - _要件: 5.3, 7.2_

- [ ] 16. 包括的テストスイートの作成
  - 完全なタイマーワークフローの統合テスト作成
  - ユーザーシナリオ用Playwrightを使用したE2Eテスト追加
  - 長期間にわたるタイマー精度テスト
  - 正しいしきい値でのベルトリガー検証
  - ブラウザセッション間の設定永続化テスト
  - クロスブラウザ互換性テスト追加
  - _要件: 7.1, 7.2, 7.3_

- [ ] 17. 最終仕上げとエラーハンドリング
  - 適切なエラー処理のためのエラーバウンダリ追加
  - ローディング状態とエラーメッセージの実装
  - 入力バリデーションフィードバックとユーザーガイダンス追加
  - バンドルサイズ最適化とコード分割実装
  - 適切なメタタグとファビコンの追加
  - 最終アクセシビリティ監査と手動テストの実施
  - _要件: 全要件の最終検証_